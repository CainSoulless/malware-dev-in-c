#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <sys/ioctl.h>
#include <net/if.h>
#include <ifaddrs.h>
#include <netdb.h>
#include <arpa/inet.h>

#include "../utils/structures.h" 
// #include "../utils/utils.h" 


// struct Interfaces interface_information()
// {
//     const char *interfaces[10];
//     int count = 0;

//     struct ifaddrs *addrs,*tmp;

//     getifaddrs(&addrs);
//     tmp = addrs;

//     while (tmp)
//     {
//         if (tmp->ifa_addr && tmp->ifa_addr->sa_family == AF_PACKET)
//         {
//             interfaces[count] = tmp->ifa_name;
//             count++;
//         }    
//         tmp = tmp->ifa_next;
//     }

//     freeifaddrs(addrs);

//     // Block oriented just for return the string's array.
//     // C stuffs, lol.
//     const char **copy_of_array = malloc(count * sizeof(*copy_of_array));
//     for (int i = 0; i < count; i++)
//     {
//         copy_of_array[i] = interfaces[i];
//     }
    
//     return copy_of_array;
// }

char *ip_information()
{
    struct hostent *host_entry;
    char hostBuffer[256];
    char *ip;

    if (gethostname(hostBuffer, sizeof(hostBuffer)))
    {
        error_print();
    }

    host_entry = gethostbyname(hostBuffer);

    ip = inet_ntoa(*((struct in_addr*)host_entry->h_addr_list[0]));
    
    return ip;
}

// void mac_information()
// {
//     struct ifreq ifr;
//     int sock;

//     // char interface[] = "wlp2s0";
//     const char * const *interface = interface_information();

//     for (int i = 0; i < 3; i++)
//     {
//         printf("%s\n", interface[i]);
//     }
// }