#include <unistd.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/resource.h>

#include "structures.h" 

size_t heap_size()
{
    void *heap_start = sbrk(0);
    int *ptr = (int *)malloc(sizeof(int));
    void *heap_end = sbrk(0);

    size_t heap_size = (size_t)(heap_end - heap_start);
    free(ptr);

    return heap_size;
}

size_t stack_size()
{
    struct rlimit limit;
    getrlimit(RLIMIT_STACK, &limit);
    size_t stack_size = limit.rlim_cur;

    return stack_size;
}

struct Program_itself program_itself_information()
{
    struct Program_itself program_itself;

    program_itself.totalMemoryInBytes = (heap_size() + stack_size());
    program_itself.totalMemoryInMb = (float)program_itself.totalMemoryInBytes / (1024 * 1024);

    return program_itself;
}